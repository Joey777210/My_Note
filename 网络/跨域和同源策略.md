# 总结JQuery+SSM实现一个前后端分离POST接口的过程中出现的跨域问题
## 问题复现
前端调用AJAX的方法，从form表单中提取出账号密码，通过post接口发送到后端进行校验。前端的method填写post，后端实现的接口method也填写了post。但提交后，前端收到login包的status为Failed或Canceled，并被标红；后端收到的数据包显示method为OPTIONS，并没有被识别为POST，没有进行任何操作，数据也无法取出。查阅资料发现是因为跨域问题。
## 问题原理
#### 什么是跨域资源共享CORS？
##### 要理解什么是跨域，首先我们要知道什么是域。
> 域就是一个软件所属的区域，当软件发出请求到不同区域的服务时，就会发生跨域现象。
> 讲到域，就要先了解同源策略
##### 什么是同源策略
> 源是由网络协议(http/https)、IP、端口共同确定的。
> 那么同网络协议，同IP，同端口的两个网站，就是同源的。
#### 跨域为什么会出现？
从前的浏览器存在跨站点攻击的问题，跨站请求伪造CSPF、跨站脚本攻击XSS等。攻击者通过钓鱼网站等，拿到你打开的网页中的cookie，并伪造你的身份访问网站，为所欲为。为了防止这个问题的发生，浏览器限制了不同网站的数据之间的访问，即数据隔离。所以我在前端，访问虽然在本地，但端口并不相同的后端，会发生不同源，被拦截的现象。  
跨域CORS其实是浏览器给不同网站的数据共享需求留的钩子，也就是网站开发者一般被限制数据共享，但如果主动开放，那么可以被不同源的网站访问。  
#### 是否同源是如何被验证的
事实上只有非简单请求（具体在下面）才会被同源策略阻挡，浏览器在向网站发出访问请求前，会先发出OPTIONS请求，其中带有关键字段Origin，表明源的地址。  
并且其中还会有两个指明后续请求特征的域：    
（1）Access-Control-Request-Method  
该字段是必须的，用来列出浏览器的CORS请求会用到哪些HTTP方法，上例是PUT。  
（2）Access-Control-Request-Headers  
该字段是一个逗号分隔的字符串，指定浏览器CORS请求会额外发送的头信息字段，上例是X-Custom-Header。  
#### 什么情况下会需要跨域数据共享
当然就是不同域名之间需要数据访问的时候。事实上准确的来说是XmlHttpRequest/AJAX请求数据时会需要跨域数据共享。
##### 为什么直接form表单提交数据不会被同源阻挡，而AJAX会？
因为原生form并非脚本，无法获取对方网站的数据，浏览器认为这是安全的。  
而通过XHR AJAX脚本需要在浏览器的V8引擎上跑，而AJAX在后台运行是无需用户同意，用户也无法察觉的。并且所有网站的脚本都在同一个V8上面跑，就有可能有恶意的AJAX脚本，恶意读取其他网站的用户数据。所以浏览器只允许未经允许的发数据，而不允许未经允许的读数据，这也就是为什么XHR AJAX被同源策略隔绝，需要CORS来进行数据交互。
##### 所有的AJAX请求都要CORS吗？
并不是。请求分为简单请求和非简单请求，//TODO
#### 如何实现CORS，解决同源策略带来的不便？
从原理上理解，就是让浏览器同意网站A向网站B请求数据。但这在市面上的商业浏览器中是做不到的，也就是说CORS无法在前端解决。我们就需要在后端进行操作。
//TODO  
